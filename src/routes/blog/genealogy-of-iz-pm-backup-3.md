---
title: '아이즈원 프라이빗 메일 백업의 계보 - 3편'
excerpt: ''
date: '2021-09-11T09:34:22.213319'
author: 탐정토끼(Taehee Kim)
tag: '비동기'
---

[아이즈원 프라이빗 메일 백업의 계보 - 1편](https://twinstae.github.io/genealogy-of-iz-pm-backup-1/)
[아이즈원 프라이빗 메일 백업의 계보 - 2편](https://twinstae.github.io/genealogy-of-iz-pm-backup-2/)

## 지난 이야기
아이즈원이 해체를 발표하고, 팬덤인 위즈원들은 아이즈원 팬 전용 SNS인 프라이빗 메일을 보존하고 백업하려 했습니다. 여러 개발자 분들은 프록시와 이어받기 방식을 이용해 Access Token을 확보하고 백업을 시도했습니다. 백업은 점점 편하고 단순해져갔지만, 아직 속도 문제가 남아 있었습니다. Python Requests 라이브러리로 만들어진 초기 백업 툴은... 8000여개가 넘는 메일을 다운 받는데 1시간이 넘는 시간이 걸렸습니다.

음. 이게 파이썬이라서 느린 걸까요? 옆집 자바 개발자님도 네이티브 자바 코드로 다운로드를 받으셨지만, 여전히 오랜 시간이 걸렸습니다. 그 이유는 언어가 느려서가 아니었습니다. 문제의 원인은 이미지를 다운 받는 동안의 네트워크 지연... 차단(Blocking)에 있었으니까요.

오늘은 비동기를 이용해 백업 시간을 Python에서도 8분, Go에서 1~3분으로 단축했던 이야기를 해보려 해요.

## 동기(Sync)와 차단(Blocking) 문제
> 만약 당신이 웹 서버와 같은 네트워크 앱을 만든다면 CPU가 병목을 일으킬 확률은 매우 적습니다. 당신이 만든 웹 서버가 요청을 처리할 때, 웹 서버는 데이터베이스 쿼리, Redis와 같은 캐시 서버로 보내는 네트워크 요청을 만들어냅니다. 데이터베이스, Redis와 같은 서비스는 빨라도 이 서비스들로 보내는 네트워크 요청은 느립니다.
> [특정 작업에 따른 속도 변화에 대한 매우 좋은 글](https://blog.codinghorror.com/the-infinite-space-between-words/)이 있습니다. 이 글에서 저자는 CPU 사이클 시간을 더 쉽게 이해할 수 있게 사람들이 사용하는 시간으로 변환해서 보여줍니다. 한 번의 CPU 사이클이 1초와 같았다면, 캘리포니아에서 뉴욕으로 보내는 네트워크 요청은 거의 4년과 맞먹습니다.
> 
> [\[번역\] 네 Python은 느립니다, 하지만 저는 신경쓰지 않습니다](https://tech.ssut.me/yes-python-is-slow-and-i-dont-care/)

## 비동기(Async)와 동시성(Concurrency)

## 병렬성(parallelism)과 동시성...

## 코루틴을 이용한 비동기 동시성

## Python 뷰어 내장 비동기 백업 툴
> [백업이 빠른 남자] 이제 백업가능시간 22시간 25분 남았군..<br>
> [백업이 빠른 남자] 비동기는 혹시<br>
> [백업이 빠른 남자] 오늘내로 되려나<br>
> ...<br>
> [ㅇㅇ] 진짜 빠르더라구요ㅋㅋ

페이지 20장 동시 처리

## Go 백업 툴 : 이진 탐색 + 동시 + 병렬
> [Gopher] 1 2 4 8 16 32 24 28 26 27<br>
> [Gopher] 요런식으로 찾거든요<br>
> [Gopher] 27페이지가 끝이라면<br>
> [Gopher] 금방 끝장부터 찾고<br>
> [Gopher] 1부터 끝페이지까지 나머진 싹다 병렬처리라<br>
> 
> 21년 6월 3일 Go개발자님과 개인적 대화

## Shelter 파이썬에서 동시 병렬 처리

## 프메 서버는 어떻게 무사했을까?


